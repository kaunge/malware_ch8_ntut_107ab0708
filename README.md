# malware homework
## ch8 BUILDING MACHINE LEARNING DETECTORS 
## ntut 資財三乙 陳旻寬 107ab0708
***
## 找到code
開啟ch8資料夾
```
//利用cd找到資料夾malware_data_science/資料夾ch8/資料夾code。絕對路徑
$ cd malware_data_science/ch8/code
//回到上一個資料夾
$ cd ..
//回到目前資料夾裡的上個資料夾裡的資料夾data。相對路徑
$ cd ../data
//查看目前資料夾的檔案
$ ls
```
執行 `run_complete_detector.sh`
```
//.sh 相似於windows的.exe
$ sh run_complete_detector.sh
```
查看或修改 .py or .sh 的內容
```
//利用vim可以打開文本查看，相似於windows的記事本
$ vim complete_detector.py 
//修改可以再進入vim後按"I"即可看到游標進行修改
//修改完保存/退出可按":wq"
```
## 使用complete_detector.py
最主要使用的是sklearn的 RandomForestClassifier 以及 FeatureHasher
運用隨機森林決策樹model的機器學習方式做病毒特徵訓練

- get_string_features  
  用regular expression去提取檔案的字作為特徵，再將這些特徵存在dict中去做雜湊(hashing trick)形成特徵值，再存於陣列中
- scan_file  
  掃描檔案並判斷為惡意(malicious)或是善意(benigin)
- train_detector  
  train_detector這副程式是用來訓練detector的，首先先用get_training_paths與抓取檔案，再抓這些檔案的內容的特徵值，之後再用RandomForest的方式去進行訓練。
- cv_evaluate  
  用隨機森林決策樹model(RandomForest)的方式得出更多數據的訓練，再去用預測出來的可能性的scores與test_y去使用ROC去分類到底檔案是惡意或善意的，最後畫出ROC curves的圖。   
  ![image](https://github.com/kaunge/malware_ch8_ntut_107ab0708/blob/main/messageImage_1610023464493.jpg)
- get_train_data  
  malware_paths 和 benignware_paths 內的檔案資料取得 training data再分為X與Y的兩堆  
  X : 從 get_string_features() 得到檔名的特徵值  
  y : malware_paths內1的數量+benignware_paths內0的數量
- main//主要程式  
  X, y = get_training_data(args.benignware_paths,args.malware_paths,hasher)  
  cv_evaluate(X,y,hasher)

## 小結
利用隨機森林決策樹model提取特徵的惡意軟件，再用接收器操作特徵（ROC）曲線測量的是檢測器的真實陽性率（成功檢測到的惡意檔案的百分比）和錯誤陽性率（被錯誤標記為惡意檔案的善意檔案的百分比）的變化。  
當靈敏度設定越高得到的假陽性(被錯誤標記為惡意檔案的善意檔案)越多，但會提高檢測率 ; 而當靈敏度設定越低，則檢測的正確率(成功檢測到的惡意檔案)越高。 

##  心得  
之前也有操作過python opedCV圖像機器學習但對於整體的操作還不夠了解，而藉由這次的惡意程式分析可以先初步了解到資料的機器學習，隨機森林更會接近我要使用的工具，剛好這個寒假我要研究隨機森林的機器學習，所以非常有幫助。  
對於本學期的課程安排我很滿意，其中還有看影集(How to Sell Drugs Online (Fast))，加上之前就有看絕命毒師(Breaking Bad)，所以這內容我都很有興趣，從販毒的手法、批貨、製毒，再來就是最難的洗錢(Money laundering)都從原始的實體搬到線上，有種時代進步的感受，但製毒的危險還是不變，人類還是最危險的因素，絕命毒師裡的炸雞叔(Gustavo Fring)說決不要跟癮君子合作，但現在透過網路就很難判斷誰是真正的癮君子，總之How to Sell Drugs Online (Fast)是部很有趣的影集。

## 參考資料
python隨機森林的youtube介紹影片   
[Machine Learning Tutorial Python - 11 Random Forest](https://youtu.be/ok2s1vV9XW0)


Hilko關於ch8的介紹 MalwareClassifier.ipynb
[Malware Detector with strings](https://github.com/hija/MalwareDataScience/blob/master/chapter08/MalwareClassifier.ipynb)


